<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"><title>2730 - Toll</title></head><body><table align="center" border="1" cellpadding="3" cellspacing="0"><tbody><tr valign="center"><td rowspan="2" align="center" valign="center"><font color="#0000a0" size="5"><b><img src="Toll_files/icono.gif"></b></font></td><td colspan="5" align="center" width="500"><font color="#0000a0" size="5"><b>2730 - Toll</b></font><br><a href="http://acmicpc-live-archive.uva.es/nuevoportal/region.php?r=wfi&amp;year=2002"><b>World Finals - Beverly Hills - 2002/2003</b></a></td></tr><tr valign="center"><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/data/p2730.pdf"><b>PDF</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/mailer.php?problem=2730"><b>Submit</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/rankprob.php?p=2730"><b>Ranking</b></a></td></tr></tbody></table><p>&nbsp;</p><p>
Sindbad the Sailor sold 66 silver spoons to the Sultan of Samarkand. The selling
was quite easy; but delivering was
complicated. The items were transported over land, passing through several towns
and villages. Each town and
village demanded an entry toll. There were no tolls for leaving. The toll for
entering a <em>village</em> was simply one item.
The toll for entering a <em>town</em> was one piece per 20 items carried.
For example, to enter a town carrying 70 items, you
had to pay 4 items as toll. The towns and villages were situated strategically
between rocks, swamps and rivers, so you could not avoid them.

</p><p>
</p><div align="center">
<!-- MATH
 $\epsfbox{p2730a.eps}$
 -->
<img src="Toll_files/p2730a.gif" alt="\epsfbox{p2730a.eps}" align="bottom" border="0">
</div>
<p>
</p><div align="center">Figure 1: To reach Samarkand with 66 spoons, traveling through a town followed
by two villages, you must start with 76 spoons.

</div>

<p>
</p><div align="center">
<!-- MATH
 $\epsfbox{p2730b.eps}$
 -->
<img src="Toll_files/p2730b.gif" alt="\epsfbox{p2730b.eps}" align="bottom" border="0">
</div>
<p>
</p><div align="center">Figure 2: The best route to reach X with 39 spoons, starting from A,
is A<!-- MATH
 $\rightarrow$
 -->
<span class="MATH"><img src="Toll_files/2730img3.gif" alt="$ \rightarrow$" align="bottom" border="0" height="16" width="22"></span>b<!-- MATH
 $\rightarrow$
 -->
<span class="MATH"><img src="Toll_files/2730img3.gif" alt="$ \rightarrow$" align="bottom" border="0" height="16" width="22"></span>c<!-- MATH
 $\rightarrow$
 -->
<span class="MATH"><img src="Toll_files/2730img3.gif" alt="$ \rightarrow$" align="bottom" border="0" height="16" width="22"></span>X,
shown with arrows in the
figure on the left. The best route to reach X with 10 spoons is A<!-- MATH
 $\rightarrow$
 -->
<span class="MATH"><img src="Toll_files/2730img3.gif" alt="$ \rightarrow$" align="bottom" border="0" height="16" width="22"></span>D<!-- MATH
 $\rightarrow$
 -->
<span class="MATH"><img src="Toll_files/2730img3.gif" alt="$ \rightarrow$" align="bottom" border="0" height="16" width="22"></span>X,
shown in the figure on the right. The
figures display towns as squares and villages as circles.

</div>

<p>
Predicting the tolls charged in each village or town is quite simple, but finding
the best route (the cheapest route) is
a real challenge. The best route depends upon the number of items carried.
For numbers up to 20, villages and towns
charge the same. For large numbers of items, it makes sense to avoid towns
and travel through more villages, as
illustrated in Figure 2.

</p><p>
You must write a program to solve Sindbad's problem. Given the number of items
to be delivered to a certain town
or village and a road map, your program must determine the total number
of items required at the beginning of the
journey that uses a cheapest route.

</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2>
The input consists of several test cases. Each test case consists of two parts:
the roadmap followed by the delivery details.

<p>
The first line of the roadmap contains an integer <span class="MATH"><i>n</i></span>, which is the number of
roads in the map (<span class="MATH">0<img src="Toll_files/2730img4.gif" alt="$ \le$" align="middle" border="0" height="30" width="18"><i>n</i></span>). Each of the next
<span class="MATH"><i>n</i></span> lines contains exactly two letters representing the two endpoints of a road.
A capital letter represents a town; a
lower case letter represents a village. Roads can be traveled in either direction.

</p><p>
Following the roadmap is a single line for the delivery details. This line
consists of three things: an integer <span class="MATH"><i>p</i></span>
(<!-- MATH
 $0 < p \le 1000$
 -->
<span class="MATH">0 &lt; <i>p</i><img src="Toll_files/2730img4.gif" alt="$ \le$" align="middle" border="0" height="30" width="18">1000</span>) for the number of items that must be delivered, a letter
for the starting place, and a letter for the place
of delivery. The roadmap is always such that the items can be delivered.

</p><p>
The last test case is followed by a line containing the number <tt>-1</tt>.

</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2>
The output consists of a single line for each test case. Each line displays
the case number and the number of items
required at the beginning of the journey. Follow the output format in the
example given below.

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2>
<pre>1
a Z
19 a Z
5
A D
D X
A b
b c
c X
39 A X
-1
</pre>

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>
<pre>Case 1: 20
Case 2: 44
</pre>

<p>
</p><hr><address>Beverly Hills 2002-2003</address><p></p></body></html>