<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"><title>2395 - Jacquard Circuits</title></head><body><table align="center" border="1" cellpadding="3" cellspacing="0"><tbody><tr valign="center"><td rowspan="2" align="center" valign="center"><font color="#0000a0" size="5"><b><img src="Jacquard%20Circuits_files/icono.gif"></b></font></td><td colspan="5" align="center" width="500"><font color="#0000a0" size="5"><b>2395 - Jacquard Circuits</b></font><br><a href="http://acmicpc-live-archive.uva.es/nuevoportal/region.php?r=wfi&amp;year=2006"><b>World Finals - Tokyo - 2006/2007</b></a></td></tr><tr valign="center"><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/data/p2395.pdf"><b>PDF</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/mailer.php?problem=2395"><b>Submit</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/rankprob.php?p=2395"><b>Ranking</b></a></td></tr></tbody></table><p>&nbsp;</p>
<p>
The eccentric sculptor Albrecht Caravaggio Mondrian has been inspired
by the history of the computer to create works of art that he calls
``Jacquard circuits." Each of his works of art consists of a series of
polygonal circuit boards (defined below), all having the same shape but
at different scales, joined together with wire or string into a
three-dimensional tiered structure. Figure 1 below shows an example
with two levels and a pentagonal shape.
</p><p>
</p><div align="center">
<!-- MATH
 $\epsfbox{p2395a.eps}$
 -->
<img src="Jacquard%20Circuits_files/p2395a.jpg" alt="\epsfbox{p2395a.eps}" align="bottom" border="0">
<tex2html_verbatim_mark>
</tex2html_verbatim_mark></div>

<p>A.C.M. (as he is known to his friends) bases his art upon the
punched hole cards of the Jacquard loom (that were later adapted by
Charles Babbage for his analytical engine) and upon the regular grid
layout approach often used in circuit interfacing (for instance, Pin
Grid Arrays). </p><p>
The circuit boards used in the sculptures are in the shapes of lattice
polygons. A lattice polygon is defined as any closed,
non-self-intersecting cycle of straight line segments that join points
with integer coordinates, with no two consecutive line segments
parallel. For any given lattice polygon <span class="MATH"><i>P</i></span>
<tex2html_verbatim_mark>, there is a smallest lattice polygon with the same shape and orientation as <span class="MATH"><i>P</i></span>
<tex2html_verbatim_mark> -- call this the <span class="textit">origin</span>. Smaller polygons of the same shape and orientation as <span class="MATH"><i>P</i></span>
<tex2html_verbatim_mark> are called its predecessors and polygons larger than <span class="MATH"><i>P</i></span>
<tex2html_verbatim_mark> are its successors. (See Figure 2 on the following page.) 

</tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></p><p>
To build one of his sculptures, A.C.M. begins by randomly selecting <span class="MATH"><i>N</i></span>
<tex2html_verbatim_mark> lattice points and then drawing a pattern by connecting these points. (Note that not all of the <span class="MATH"><i>N</i></span>
<tex2html_verbatim_mark> points are necessarily vertices of a lattice
polygon. This may happen, for example, if three or more consecutive
points are collinear.) Let <span class="MATH"><i>P</i></span>
<tex2html_verbatim_mark> be the lattice polygon determined by the pattern. Then he determines the origin corresponding to <span class="MATH"><i>P</i></span>
<tex2html_verbatim_mark>, selects the number of levels, <span class="MATH"><i>M</i></span>
<tex2html_verbatim_mark>, he wishes to use, and constructs the first <span class="MATH"><i>M</i></span>
<tex2html_verbatim_mark> polygonal circuit boards in the series (that is, the origin and its first <span class="MATH"><i>M</i> - 1</span>
<tex2html_verbatim_mark> successors). Each lattice point lying strictly
within the boundary of any of these polygons is a hole where strings or
wires meet. </tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></p><p>
The hard part of creating the sculpture is tying together all the
strings or wires that meet at a given hole. Furthermore, some of
A.C.M.'s famous miniaturized sculptures, built using nano-engineering
techniques, involve hundreds of thousands of levels. Mondrian would
like a way to determine, given a polygonal shape and the number of
levels, how many holes there will be in the final sculpture. You must
write a program to help him. (For example, the sculpture in Figure 1
above has 15 holes.) Assume holes have zero diameter.
</p><p>
</p><div align="center">
<!-- MATH
 $\epsfbox{p2395b.eps}$
 -->
<img src="Jacquard%20Circuits_files/p2395b.jpg" alt="\epsfbox{p2395b.eps}" align="bottom" border="0">
<tex2html_verbatim_mark>
</tex2html_verbatim_mark></div>

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2>

<p>
The input consists of one or more test cases. Each case begins with a line containing two positive integers <span class="MATH"><i>N</i></span>
<tex2html_verbatim_mark> <!-- MATH
 $(3 \le N \le 1000)$
 -->
<span class="MATH">(3<img src="Jacquard%20Circuits_files/2395img3.png" alt="$ \le$" align="middle" border="0" height="31" width="18"><i>N</i><img src="Jacquard%20Circuits_files/2395img3.png" alt="$ \le$" align="middle" border="0" height="31" width="18">1000)</span>
<tex2html_verbatim_mark> and <span class="MATH"><i>M</i></span>
<tex2html_verbatim_mark> <!-- MATH
 $(1 \le M \le 1000000)$
 -->
<span class="MATH">(1<img src="Jacquard%20Circuits_files/2395img3.png" alt="$ \le$" align="middle" border="0" height="31" width="18"><i>M</i><img src="Jacquard%20Circuits_files/2395img3.png" alt="$ \le$" align="middle" border="0" height="31" width="18">1000000)</span>
<tex2html_verbatim_mark>. <span class="MATH"><i>N</i></span>
<tex2html_verbatim_mark> is the number of lattice points Mondrian selected and <span class="MATH"><i>M</i></span>
<tex2html_verbatim_mark> is the number of levels in the completed sculpture. Each of the next <span class="MATH"><i>N</i></span>
<tex2html_verbatim_mark> lines contains two integers <span class="MATH"><i>x</i></span>
<tex2html_verbatim_mark>, <span class="MATH"><i>y</i></span>
<tex2html_verbatim_mark> <!-- MATH
 $(|x|, |y| \le 1000000)$
 -->
<span class="MATH">(| <i>x</i>|,| <i>y</i>|<img src="Jacquard%20Circuits_files/2395img3.png" alt="$ \le$" align="middle" border="0" height="31" width="18">1000000)</span>
<tex2html_verbatim_mark> which denote the coordinates of one of Mondrian's points. Points are listed in either clockwise or counterclockwise order. 

</tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></p><p>
The last test case is followed by a line containing two zeroes.

</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2>

<p>
For each test case, print a line containing the test case number (beginning with 1) followed by the number of holes in an <span class="MATH"><i>M</i></span>
<tex2html_verbatim_mark>-level sculpture starting from the origin
polygon of the given pattern. In no case will this value exceed the
maximum possible value of a 64-bit signed integer.
</tex2html_verbatim_mark></p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2>

<p>
</p><pre>5 2 
0 0 
8 0 
12 4 
8 8 
0 8 
3 2 
-1 -1 
3 1 
5 -1 
0 0
</pre> 

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>

<p>
</p><pre>Case 1: 15 
Case 2: 2
</pre> 

<p>
</p><hr><address>Tokyo 2006-2007</address><p><b>Tests-Setter:</b> Shahriar Manzoor<br></p></body></html>