<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"><title>2993 - Carl the Ant</title></head><body><table align="center" border="1" cellpadding="3" cellspacing="0"><tbody><tr valign="center"><td rowspan="2" align="center" valign="center"><font color="#0000a0" size="5"><b><img src="Carl%20the%20Ant_files/icono.gif"></b></font></td><td colspan="5" align="center" width="500"><font color="#0000a0" size="5"><b>2993 - Carl the Ant</b></font><br><a href="http://acmicpc-live-archive.uva.es/nuevoportal/region.php?r=wfi&amp;year=2003"><b>World Finals - Prague - 2003/2004</b></a></td></tr><tr valign="center"><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/data/p2993.pdf"><b>PDF</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/mailer.php?problem=2993"><b>Submit</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/rankprob.php?p=2993"><b>Ranking</b></a></td></tr></tbody></table><p>&nbsp;</p><p>
Ants leave small chemical trails on the ground in order to mark paths for other ants to follow. Ordinarily these
trails follow rather straight lines. But in one ant colony there is an ant named Carl, and Carl is not an ordinary
ant. Carl will often zigzag for no apparent reason, sometimes crossing his own path numerous times in the
process. When other ants come to an intersection, they always follow the path with the strongest scent, which is
the most recent path that leads away from the intersection point.

</p><p>
Ants are 1 centimeter long, move and burrow at 1 centimeter per second,
and follow their paths exactly (bending
at right angles when moving around corners). Ants cannot cross or
overlap each other. If two ants meet at the
exact same instant at an intersection point, the one that has been on
Carl's path the longest has the right of way;
if they don't arrive at the same time at the intersection point, the
ant that has been waiting the longest at the intersection will move
first.
</p><p>
Carl burrows up from the ground to start at the origin at time 0. He then walks his path and burrows back down
into the ground at the endpoint. The rest of the ants follow at regular intervals. Given the description of Carl's
path and when the other ants start the path, you are to determine how long it takes the entire set of ants to finish
burrowing back into the ground. All the ants are guaranteed to finish.

</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2>
Input consists of several test cases. The first line of the input file contains a single integer indicating the number
of test cases .

<p>
The input for each test case starts with a single line containing three positive integers <span class="MATH"><i>n</i></span> (<!-- MATH
 $1 \le n \le 50$
 -->
<span class="MATH">1<img src="Carl%20the%20Ant_files/2993img1.gif" alt="$ \le$" align="middle" border="0" height="30" width="18"><i>n</i><img src="Carl%20the%20Ant_files/2993img1.gif" alt="$ \le$" align="middle" border="0" height="30" width="18">50</span>),
<span class="MATH"><i>m</i></span> (<!-- MATH
 $1 \le m \le 100$
 -->
<span class="MATH">1<img src="Carl%20the%20Ant_files/2993img1.gif" alt="$ \le$" align="middle" border="0" height="30" width="18"><i>m</i><img src="Carl%20the%20Ant_files/2993img1.gif" alt="$ \le$" align="middle" border="0" height="30" width="18">100</span>), and <span class="MATH"><i>d</i></span> (<!-- MATH
 $1 \le d \le 100$
 -->
<span class="MATH">1<img src="Carl%20the%20Ant_files/2993img1.gif" alt="$ \le$" align="middle" border="0" height="30" width="18"><i>d</i><img src="Carl%20the%20Ant_files/2993img1.gif" alt="$ \le$" align="middle" border="0" height="30" width="18">100</span>). Here, <span class="MATH"><i>n</i></span> is the number of line segments in Carl's path, <span class="MATH"><i>m</i></span> is
the number of ants traveling the path (including Carl), and <span class="MATH"><i>d</i></span> is the time delay before each successive ant's emergence.
Carl (who is numbered 0) starts at time 0. The next ant (ant number 1) will emerge at time <span class="MATH"><i>d</i></span>, the next at time 2<span class="MATH"><i>d</i></span>, and
so on. If the burrow is blocked, the ants will emerge as soon as possible in the correct order.

</p><p>
Each of the next <span class="MATH"><i>n</i></span> lines for the test case consists of a unique integer pair <span class="MATH"><i>x</i>&nbsp;<i>y</i></span> (<!-- MATH
 $-100 \le x, y \le 100$
 -->
<span class="MATH">-100<img src="Carl%20the%20Ant_files/2993img1.gif" alt="$ \le$" align="middle" border="0" height="30" width="18"><i>x</i>, <i>y</i><img src="Carl%20the%20Ant_files/2993img1.gif" alt="$ \le$" align="middle" border="0" height="30" width="18">100</span>), which is
the endpoint of a line segment of Carl's path, in the order that Carl travels. The first line starts at the origin (0,0)
and the starting point of every subsequent line is the endpoint of the previous line.

</p><p>
For simplicity, Carl always travels on line segments parallel to the axes, and no endpoints lie on any segment
other than the ones which they serve as an endpoint. Input line segments will only intersect orthogonally.
Every pair of segments can have at most one common point. The common point will be strictly inside both segments.


</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2>
The output for each case is described as follows:

<p>

</p><p></p><p>
<br>

<tt>Case <span class="MATH"><i>C</i></span>:</tt>

</p><p>

<tt>Carl finished the path at time </tt><span class="MATH"><i>t</i><sub>1</sub></span>

</p><p>

<tt>The ants finished in the following order:</tt>

</p><p>

<!-- MATH
 $a_1 a_2 a_3 \dots a_m$
 -->
<span class="MATH"><i>a</i><sub>1</sub><i>a</i><sub>2</sub><i>a</i><sub>3</sub>...<i>a</i><sub>m</sub></span>

</p><p>

<tt>The last ant finished the path at time </tt><span class="MATH"><i>t</i><sub>2</sub></span>

</p><p>

</p><p></p><p>
<br>
Here, <span class="MATH"><i>C</i></span> is the case number (starting at 1), <!-- MATH
 $a_1, a_2, a_3 , \dots, a_m$
 -->
<span class="MATH"><i>a</i><sub>1</sub>, <i>a</i><sub>2</sub>, <i>a</i><sub>3</sub>,..., <i>a</i><sub>m</sub></span> are the ant numbers in the order that they go
back underground, and <span class="MATH"><i>t</i><sub>1</sub></span> and <span class="MATH"><i>t</i><sub>2</sub></span> are the times (in seconds) at which Carl and the last ant finish going
underground. You should separate consecutive cases with a single blank line.

</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2>
<pre>2
4 7 4
0 4
2 4
2 2
-2 2
4 7 2
0 4
2 4
2 2
-2 2
</pre>

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>
<pre>Case 1:
Carl finished the path at time 13
The ants finished in the following order:
0 2 1 3 4 5 6
The last ant finished the path at time 29

Case 2:
Carl finished the path at time 13
The ants finished in the following order:
0 4 1 5 2 6 3
The last ant finished the path at time 19
</pre>

<p>
</p><hr><address>Prague 2003-2004</address><p><b>Tests-Setter:</b> Rujia Liu<br><b>Special Thanks:</b> Chen Danqi, Derek Kisman<br></p></body></html>