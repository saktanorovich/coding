<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"><title>3001 - Suspense!</title></head><body><table align="center" border="1" cellpadding="3" cellspacing="0"><tbody><tr valign="center"><td rowspan="2" align="center" valign="center"><font color="#0000a0" size="5"><b><img src="Suspense%21_files/icono.gif"></b></font></td><td colspan="5" align="center" width="500"><font color="#0000a0" size="5"><b>3001 - Suspense!</b></font><br><a href="http://acmicpc-live-archive.uva.es/nuevoportal/region.php?r=wfi&amp;year=2003"><b>World Finals - Prague - 2003/2004</b></a></td></tr><tr valign="center"><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/data/p3001.pdf"><b>PDF</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/mailer.php?problem=3001"><b>Submit</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/rankprob.php?p=3001"><b>Ranking</b></a></td></tr></tbody></table><p>&nbsp;</p><p>
Jan and Tereza live in adjoining buildings and their apartments face one another. For their school science
project, they want to construct a miniature suspension bridge made of rope, string, and cardboard connecting
their two buildings. Two pieces of identical-length rope form the main suspension cables, which are attached to
the bottoms of their windows. The cardboard ``roadbed" of the bridge is held up by numerous strings tied to the
main cables. The horizontal bridge roadbed lies exactly one meter below the lowest point of the ropes. For
aesthetic reasons, the roadbed should be at least two meters below the lower edge of the lower of the two
students' windows. The laws of physics dictate that each suspension rope forms a parabola.

</p><p>
While Jan and Tereza don't plan to walk on this model bridge, there is a serious problem: some of the occupants
of the apartment buildings own pet cats, and others own pet birds. Jan and Tereza want to be sure that their
bridge doesn't provide a way for a cat to reach a bird. Jan and Tereza have observed that a cat cannot jump as
high as 0.5 meters, and will not jump down as far as 3 meters. So as long as the bridge roadbed lies at least 0.5
meters above the bottom of a cat's window, or at least 3 meters below the bottom of a cat's window, the cat will
not jump onto it. Likewise, a cat that successfully jumps onto the roadbed will not be able to reach a bird's
window if the roadbed lies at least 0.5 meters below the bottom of the bird's window, or at least 3 meters above
the bottom of the bird's window. Cats are concerned only with reaching birds, and they do not worry about
returning home.

</p><p>
The figure below shows Jan's apartment (``<b>J</b>") and Tereza's apartment (``<b>T</b>") with a rope joining the bottoms of
their windows and the cardboard roadbed one meter below the lowest point of the rope. The cat on the second
floor can reach the bird on the second floor using the bridge.

</p><p>
</p><div align="center">
<!-- MATH
 $\epsfbox{p3001.eps}$
 -->
<img src="Suspense%21_files/p3001.gif" alt="\epsfbox{p3001.eps}" align="bottom" border="0" height="402" width="632">
</div>

<p>
You must write a program to determine how much rope Jan and Tereza need to construct each cable for a bridge
that won't endanger any of the birds in their two buildings.

</p><p>
Input for your program will be: the distance between the two buildings, in meters; the floor numbers for Jan and
Tereza (with the lowest, or ground floor in each building numbered 1), the kinds of pets living in all the floors
up through Jan's floor, and the kinds of pets living in all the floors up through Tereza's floor. Your program
must determine the length of the longest cable that can be used to suspend a bridge between the two buildings
that does not permit any cat to reach a bird by means of the bridge. The roadbed of the bridge must lie at least 1
meter above the ground and must lie exactly one meter below the lowest point of the suspension cables. It must
also lie at least two meters below the lower of the two windows of Jan and Tereza. All rooms in the buildings
are exactly 3 meters tall; all windows are exactly 1.5 meters tall and the bottom of each window lies exactly 1
meter above the floor of each room.

</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2>
The input will describe several cases, each of which has three lines. The first line will contain two positive
integers <span class="MATH"><i>j</i></span> and <span class="MATH"><i>t</i></span> (<!-- MATH
 $2 \le j, t \le 25$
 -->
<span class="MATH">2<img src="Suspense%21_files/3001img2.gif" alt="$ \le$" align="middle" border="0" height="30" width="18"><i>j</i>, <i>t</i><img src="Suspense%21_files/3001img2.gif" alt="$ \le$" align="middle" border="0" height="30" width="18">25</span>) representing Jan's floor and Tereza's floor, and a real value
<span class="MATH"><i>d</i></span> (<!-- MATH
 $1 \le d \le 25$
 -->
<span class="MATH">1<img src="Suspense%21_files/3001img2.gif" alt="$ \le$" align="middle" border="0" height="30" width="18"><i>d</i><img src="Suspense%21_files/3001img2.gif" alt="$ \le$" align="middle" border="0" height="30" width="18">25</span>)
representing the distance, in meters, between the buildings. The second line will contain <span class="MATH"><i>j</i></span> uppercase letters
<!-- MATH
 $l_1, l_2, \dots, l_j$
 -->
<span class="MATH"><i>l</i><sub>1</sub>, <i>l</i><sub>2</sub>,..., <i>l</i><sub>j</sub></span> separated by whitespace. Letter <span class="MATH"><i>l</i><sub>k</sub></span> is `<tt>B</tt>' if a bird lives on floor
number <span class="MATH"><i>k</i></span> of Jan's building, `<tt>C</tt>' if a cat lives
on floor number <span class="MATH"><i>k</i></span>, and `<tt>N</tt>' if neither kind of pet lives on floor number <span class="MATH"><i>k</i></span>. The third line similarly contains <span class="MATH"><i>t</i></span>
uppercase letters representing the same kind of information for the floor <span class="MATH"><i>s</i></span> in Tereza's building. The last case is
followed by a line containing three zeroes.

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2>
For each case, print the case number (1, 2, ...) and the largest value <span class="MATH"><i>c</i></span> such that two cables, each of length <span class="MATH"><i>c</i></span>, can
be used to suspend a bridge from the lower edges  of Jan's and Tereza's windows so that the bridge floor lies one
meter below the lowest point in the cable, lies at least 1 meter above the ground, lies at least two meters below
Jan and Tereza's windows, and does not allow a cat to reach a bird. The lengt <span class="MATH"><i>h</i></span> should be rounded to three
places following the decimal point. If no such bridge can be constructed, print `<tt>impossible</tt>'. Print a blank line
between the output for consecutive cases. Your output format should imitate the sample output.

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2>
<pre>4 3 5.0
N C N C
N B B
4 3 5.0
C B C C
B C B
0 0 0
</pre>

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>
<pre>Case 1: 14.377

Case 2: impossible
</pre>

<p>
</p><hr><address>Prague 2003-2004</address><p><b>Tests-Setter:</b> Rujia Liu<br><b>Special Thanks:</b> Pengqi Cheng<br></p></body></html>