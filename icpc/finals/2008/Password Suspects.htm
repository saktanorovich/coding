<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"><title>4126 - Password Suspects</title></head><body><table align="center" border="1" cellpadding="3" cellspacing="0"><tbody><tr valign="center"><td rowspan="2" align="center" valign="center"><font color="#0000a0" size="5"><b><img src="Password%20Suspects_files/icono.gif"></b></font></td><td colspan="5" align="center" width="500"><font color="#0000a0" size="5"><b>4126 - Password Suspects</b></font><br><a href="http://acmicpc-live-archive.uva.es/nuevoportal/region.php?r=wfi&amp;year=2007"><b>World Finals - Banff Springs, Alberta - 2007/2008</b></a></td></tr><tr valign="center"><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/data/p4126.pdf"><b>PDF</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/mailer.php?problem=4126"><b>Submit</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/rankprob.php?p=4126"><b>Ranking</b></a></td></tr></tbody></table><p>&nbsp;</p>
<p>
You are the computer whiz for the secret organization known as the <span class="textit">Sneaky Underground Smug Perpetrators of Evil Crimes and Thefts</span>. The target for SUSPECT's latest evil crime is their greatest foe, the <span class="textit">Indescribably Clever Policemen's Club</span>, and everything is prepared. Everything, except for one small thing: the secret password for ICPC's main computer system. 

</p><p>
The password is known to consist only of lowercase letters `a'-`z'.
Furthermore, through various sneaky observations, you have been able to
determine the length of the password, as well as a few (possibly
overlapping) substrings of the password, though you do not know exactly
where in the password they occur. </p><p>
For instance, say that you know that the password is 10 characters long, and that you have observed the substrings ``<tt>hello</tt>" and ``<tt>world</tt>". Then the password must be either ``<tt>helloworld</tt>" or ``<tt>worldhello</tt>".

</p><p>
The question is whether this information is enough to reduce the number
of possible passwords to a reasonable amount. To answer this, your task
is to write a program that determines the number of possible passwords
and, if there are at most 42 of them, prints them all. </p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2> 

<p>
The input file contains several test cases. Each test case begins with a line containing two integers <span class="MATH"><i>N</i></span>
<tex2html_verbatim_mark> and <span class="MATH"><i>M</i></span>
<tex2html_verbatim_mark> <!-- MATH
 $(1 \le N \le 25, 0 \le M \le 10)$
 -->
<span class="MATH">(1<img src="Password%20Suspects_files/4126img1.png" alt="$ \le$" align="middle" border="0" height="31" width="18"><i>N</i><img src="Password%20Suspects_files/4126img1.png" alt="$ \le$" align="middle" border="0" height="31" width="18">25, 0<img src="Password%20Suspects_files/4126img1.png" alt="$ \le$" align="middle" border="0" height="31" width="18"><i>M</i><img src="Password%20Suspects_files/4126img1.png" alt="$ \le$" align="middle" border="0" height="31" width="18">10)</span>
<tex2html_verbatim_mark>, giving the length of the password and the number of known substrings respectively. This is followed by <span class="MATH"><i>M</i></span>
<tex2html_verbatim_mark> lines, each containing a known substring. Each known substring consists of between 1 and 10 lowercase letters `a'-`z'. 

</tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></p><p>
The last test case is followed by a line containing two zeroes. 

</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2> 

<p>
For each test case, print the case number (beginning with 1) followed by `<span class="MATH"><i>Y</i></span>
<tex2html_verbatim_mark> <tt>suspects</tt>', where <span class="MATH"><i>Y</i></span>
<tex2html_verbatim_mark> is the number of possible passwords for this
case. If the number of passwords is at most 42, then output all
possible passwords in alphabetical order, one per line.
</tex2html_verbatim_mark></tex2html_verbatim_mark></p><p>
The input will be such that the number of possible passwords at most <span class="MATH">10<sup>15</sup></span>
<tex2html_verbatim_mark>.

</tex2html_verbatim_mark></p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2> 

<p>
</p><pre>10 2 
hello 
world 
10 0 
4 1 
icpc 
0 0
</pre>

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2>

<p>
</p><pre>Case 1: 2 suspects 
helloworld 
worldhello 
Case 2: 141167095653376 suspects 
Case 3: 1 suspects 
icpc
</pre>

<p>
</p><hr><address>Banff Springs, Alberta 2007-2008</address><p><b>Tests-Setter:</b> Derek Kisman<br></p></body></html>