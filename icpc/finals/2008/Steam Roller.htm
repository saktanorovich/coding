<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"><title>4128 - Steam Roller</title></head><body><table align="center" border="1" cellpadding="3" cellspacing="0"><tbody><tr valign="center"><td rowspan="2" align="center" valign="center"><font color="#0000a0" size="5"><b><img src="Steam%20Roller_files/icono.gif"></b></font></td><td colspan="5" align="center" width="500"><font color="#0000a0" size="5"><b>4128 - Steam Roller</b></font><br><a href="http://acmicpc-live-archive.uva.es/nuevoportal/region.php?r=wfi&amp;year=2007"><b>World Finals - Banff Springs, Alberta - 2007/2008</b></a></td></tr><tr valign="center"><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/data/p4128.pdf"><b>PDF</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/mailer.php?problem=4128"><b>Submit</b></a></td><td width="100">&nbsp;</td><td align="center" width="100"><a href="http://acmicpc-live-archive.uva.es/nuevoportal/rankprob.php?p=4128"><b>Ranking</b></a></td></tr></tbody></table><p>&nbsp;</p>
<p>
Johnny drives a steam roller, which like all steam rollers is slow and
takes a relatively long time to start moving, change direction, and
brake to a full stop. Johnny has just finished his day's work and is
driving his steam roller home to see his wife. Your task is to find the
fastest path for him and his steam roller. </p><p>
The city where Johnny lives has a regular structure (the streets form
an orthogonal system). The city streets are laid out on a rectangular
grid of intersections. Each intersection is connected to its neighbors
(up to four of them) by a street. Each street is exactly one block
long. When Johnny enters a street, he must always travel to the other
end (continue to the next intersection). From that point, he can
continue in any of the four possible directions to another
intersection, and so on. </p><p>
By studying the road conditions of the streets, Johnny has calculated
the time needed to go from one end to the other of every street in
town. The time is the same for both directions. However, Johnny's
calculations hold only under the ideal condition that the steam roller
is already in motion when it enters a street and does not need to
accelerate or brake. Whenever the steam roller changes direction at a
intersection directly before or after a street, the estimated ideal
time for that street must be doubled. The same holds if the roller
begins moving from a full stop (for example at the beginning of
Johnny's trip) or comes to a full stop (for example at the end of his
trip). </p><p>
The following picture shows an example. The numbers show the ``ideal"
times needed to drive through the corresponding streets. Streets with
missing numbers are unusable for steam rollers. Johnny wants to go from
the top-left corner to the bottom-right one. </p><p>
</p><div align="center">
<!-- MATH
 $\epsfbox{p4128.eps}$
 -->
<img src="Steam%20Roller_files/p4128.png" alt="\epsfbox{p4128.eps}" align="bottom" border="0" height="382" width="382">
<tex2html_verbatim_mark>
</tex2html_verbatim_mark></div>

<p>
The path consisting of streets labeled with 9's seems to be faster at
the first sight. However, due to the braking and accelerating
restrictions, it takes double the estimated time for every street on
the path, making the total time 108. The path along the streets labeled
with 10's is faster because Johnny can drive two of the streets at the
full speed, giving a total time of 100.
</p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001001000000000000000">
Input</a>&nbsp;</font>
</h2> 

<p>
The input consists of several test cases. Each test case starts with six positive integer numbers: <span class="MATH"><i>R</i></span>
<tex2html_verbatim_mark>, <span class="MATH"><i>C</i></span>
<tex2html_verbatim_mark>, <span class="MATH"><i>r</i><sub>1</sub></span>
<tex2html_verbatim_mark>, <span class="MATH"><i>c</i><sub>1</sub></span>
<tex2html_verbatim_mark>, <span class="MATH"><i>r</i><sub>2</sub></span>
<tex2html_verbatim_mark>, and <span class="MATH"><i>c</i><sub>2</sub></span>
<tex2html_verbatim_mark>. <span class="MATH"><i>R</i></span>
<tex2html_verbatim_mark> and <span class="MATH"><i>C</i></span>
<tex2html_verbatim_mark> describe the size of the city, <span class="MATH"><i>r</i><sub>1</sub></span>
<tex2html_verbatim_mark>, <span class="MATH"><i>c</i><sub>1</sub></span>
<tex2html_verbatim_mark> are the starting coordinates, and <span class="MATH"><i>r</i><sub>2</sub></span>
<tex2html_verbatim_mark>, <span class="MATH"><i>c</i><sub>2</sub></span>
<tex2html_verbatim_mark> are the coordinates of Johnny's home. The
starting coordinates are different from the coordinates of Johnny's
home. The numbers satisfy the following condition:<!-- MATH
 $1 \le r_{1}, r_{2} \le R \le 100$
 -->
 <span class="MATH">1<img src="Steam%20Roller_files/4128img2.png" alt="$ \le$" align="middle" border="0" height="31" width="18"><i>r</i><sub>1</sub>, <i>r</i><sub>2</sub><img src="Steam%20Roller_files/4128img2.png" alt="$ \le$" align="middle" border="0" height="31" width="18"><i>R</i><img src="Steam%20Roller_files/4128img2.png" alt="$ \le$" align="middle" border="0" height="31" width="18">100</span>
<tex2html_verbatim_mark>, <!-- MATH
 $1 \le c_{1}, c_{2} \le C \le 100$
 -->
<span class="MATH">1<img src="Steam%20Roller_files/4128img2.png" alt="$ \le$" align="middle" border="0" height="31" width="18"><i>c</i><sub>1</sub>, <i>c</i><sub>2</sub><img src="Steam%20Roller_files/4128img2.png" alt="$ \le$" align="middle" border="0" height="31" width="18"><i>C</i><img src="Steam%20Roller_files/4128img2.png" alt="$ \le$" align="middle" border="0" height="31" width="18">100</span>
<tex2html_verbatim_mark>.

</tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></p><p>
After the six numbers, there are <span class="MATH"><i>C</i> - 1</span>
<tex2html_verbatim_mark> non-negative integers describing the time
needed to drive on streets between intersections (1,1) and (1,2), (1,2)
and (1,3), (1,3) and (1,4), and so on. Then there are <span class="MATH"><i>C</i></span>
<tex2html_verbatim_mark> non-negative integers describing the time need
to drive on streets between intersections (1,1) and (2,1), (1,2) and
(2,2), and so on. After that, another <span class="MATH"><i>C</i> - 1</span>
<tex2html_verbatim_mark> non-negative integers describe the next row of
streets across the width of the city. The input continues in this way
to describe all streets in the city. Each integer specifies the time
needed to drive through the corresponding street (not higher than
10000), provided the steam roller proceeds straight through without
starting, stopping, or turning at either end of the street. If any
combination of one or more of these events occurs, the time is
multiplied by two. Any of these integers may be zero, in which case the
corresponding street cannot be used at all. </tex2html_verbatim_mark></tex2html_verbatim_mark></tex2html_verbatim_mark></p><p>
The last test case is followed by six zeroes. 

</p><p>
All numbers are separated with at least one whitespace character
(space, tab, or newline), but any amount of additional whitespace
(including empty lines) may be present to improve readability. </p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001002000000000000000">
Output</a>&nbsp;</font>
</h2> 

<p>
For each test case, print the case number (beginning with 1) followed by the minimal time needed to go from intersection <!-- MATH
 $r_{1}, c_{1}$
 -->
<span class="MATH"><i>r</i><sub>1</sub>, <i>c</i><sub>1</sub></span>
<tex2html_verbatim_mark> to <!-- MATH
 $r_{2}, c_{2}$
 -->
<span class="MATH"><i>r</i><sub>2</sub>, <i>c</i><sub>2</sub></span>
<tex2html_verbatim_mark>. If the trip cannot be accomplished (due to unusable streets), print the word `<tt>Impossible</tt>' instead.

</tex2html_verbatim_mark></tex2html_verbatim_mark></p><p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001003000000000000000">
Sample Input</a>&nbsp;</font>
</h2> 

<p>
</p><pre>4 4 1 1 4 4 
 10  10  10 
9  0  0  10 
  0  0  0 
9  0  0  10 
  9  0  0 
0  9  0  10 
  0  9  9 

2 2 1 1 2 2 0 1 1 0 

0 0 0 0 0 0
</pre>

<p>

</p><h2><font color="#ff0000" size="4"><a name="SECTION0001004000000000000000">
Sample Output</a>&nbsp;</font>
</h2> 

<p>
</p><pre>Case 1: 100 
Case 2: Impossible
<hr><address>Banff Springs, Alberta 2007-2008</address><p><b>Tests-Setter:</b> Derek Kisman<br></p></pre></body></html>